' *******************************************************************************
' Copyright (c) 2025 Elektrobit Automotive GmbH
'
' See the NOTICE file(s) distributed with this work for additional
' information regarding copyright ownership.
'
' This program and the accompanying materials are made available under the
' terms of the Apache License Version 2.0 which is available at
' https://www.apache.org/licenses/LICENSE-2.0
'
' SPDX-License-Identifier: Apache-2.0
' *******************************************************************************

@startuml
hide empty description

state Not_available
state Available
state Event_subscribed
state Event_subscribed_acknowledged as "Event_subscribed_acknowledged (optional)"

[*] --> Not_available
Not_available --> Available: Client_connector::Callbacks::\non_service_state_change\n(Service_state::available)

Available --> Not_available: Client_connector::Callbacks::\non_service_state_change\n(!Service_state::available)
Available --> Event_subscribed: Client_connector::\nsubscribe_event()

Event_subscribed --> Available: Client_connector::\nunsubscribe_event()
Event_subscribed --> Event_subscribed_acknowledged: Client_connector::Callbacks::\non_event_subscription_status_change\n(Event_state::subscribed)
Event_subscribed --> Not_available: Client_connector::Callbacks::\non_service_state_change\n(!Service_state::available)

Event_subscribed_acknowledged --> Available: Client_connector::\nunsubscribe_event()
Event_subscribed_acknowledged --> Event_subscribed: Client_connector::Callbacks::\non_event_subscription_status_change\n(Event_state::unsubscribed)
Event_subscribed_acknowledged --> Not_available: Client_connector::Callbacks::\non_service_state_change\n(!Service_state::available)

note bottom of Event_subscribed_acknowledged
  State can be toggled via calling Enabled_server_connector::Event::set_subscription_state().
  Events are delivered in both Event_subscribed and Event_subscribed_acknowledged states.
end note

@enduml
